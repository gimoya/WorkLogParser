<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>WhatsApp Chat Parser</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>WhatsApp Chat Parser</h1>
        
        <form id="parseForm">
            <div class="form-group">
                <label for="fileInput">WhatsApp Chat Export ausw√§hlen:</label>
                <div class="file-input-wrapper">
                <input 
                    type="file" 
                    id="fileInput" 
                    accept=".zip"
                    required
                >
                    <label for="fileInput" class="file-input-label">
                        <span class="file-input-icon">üìÅ</span>
                        <span class="file-input-text">Datei ausw√§hlen</span>
                    </label>
                    <span class="file-input-filename" id="fileName">Keine Datei ausgew√§hlt</span>
                </div>
                <small style="color: #666; display: block; margin-top: 8px;">
                    W√§hlen Sie eine ZIP-Datei mit WhatsApp-Chat-Export (.txt Dateien)
                </small>
            </div>
            <button type="submit" id="parseBtn">Chat export parsen</button>
        </form>

        <div id="loading" class="loading">Lade und parse Chat-Export...</div>
        <div id="error" class="error"></div>
        <div id="parseLog" style="display: none; margin: 20px 0; padding: 15px; background: #e7f3ff; border: 1px solid #b3d9ff; border-radius: 4px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto;">
            <h3 style="margin: 0 0 10px 0; color: #004085;">üìã Parsing Log</h3>
            <div id="parseLogContent" style="white-space: pre-wrap;"></div>
        </div>

        <div id="results" class="results">
            <div class="statistics" id="statistics"></div>
            <div id="summaryTables"></div>
                    <div id="unmatchedMessages" style="display: none; margin-bottom: 20px; padding: 15px; background: #fff3cd; border: 1px solid #ffc107; border-radius: 4px;">
                        <h3 style="margin: 0 0 10px 0; color: #856404;">‚ö†Ô∏è Unmatched Messages (No Fields Extracted)</h3>
                        <div id="unmatchedMessagesList" style="max-height: 200px; overflow-y: auto;"></div>
                    </div>
            <div id="dateFilter" class="date-filter" style="display: none; margin-bottom: 20px; padding: 15px; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px;">
                <h3 style="margin: 0 0 15px 0;">Date Filter</h3>
                <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label for="fromDate" style="font-weight: 500;">From:</label>
                        <input type="date" id="fromDate" style="padding: 6px 10px; border: 1px solid #ced4da; border-radius: 4px; font-size: 14px;">
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label for="toDate" style="font-weight: 500;">To:</label>
                        <input type="date" id="toDate" style="padding: 6px 10px; border: 1px solid #ced4da; border-radius: 4px; font-size: 14px;">
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label for="gotoDate" style="font-weight: 500;">Go to Date:</label>
                        <input type="date" id="gotoDate" style="padding: 6px 10px; border: 1px solid #ced4da; border-radius: 4px; font-size: 14px;">
                        <button type="button" id="gotoDateBtn" style="padding: 6px 12px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">Go</button>
                    </div>
                </div>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h3 style="margin: 0;">Work Log:</h3>
                        <button type="button" id="exportBtn" style="padding: 8px 16px; background: #25D366; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; display: inline-block;">
                    CSV Export
                </button>
            </div>
            <div class="messages-table-wrapper">
                <table class="messages-table" id="messagesTable">
                    <colgroup>
                        <col class="col-msg-date">
                        <col class="col-date">
                        <col class="col-name">
                        <col class="col-start-time">
                        <col class="col-end-time">
                        <col class="col-break">
                        <col class="col-netto">
                        <col class="col-regie">
                        <col class="col-regie-type">
                        <col class="col-message">
                    </colgroup>
                    <thead>
                        <tr>
                            <th class="col-msg-date">Msg Date</th>
                            <th class="col-date">Date</th>
                            <th class="col-name">Worker</th>
                            <th class="col-start-time">Start</th>
                            <th class="col-end-time">End</th>
                            <th class="col-break">Break</th>
                            <th class="col-netto">Netto</th>
                            <th class="col-regie">Regie-hrs</th>
                            <th class="col-regie-type">Regie-type</th>
                            <th class="col-message">Log-Text</th>
                        </tr>
                    </thead>
                    <tbody id="messagesList">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>